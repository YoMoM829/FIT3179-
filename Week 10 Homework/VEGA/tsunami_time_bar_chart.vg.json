{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": { 
    "text": {"expr": "'Tsunami Magnitudes (' + Start + ' to ' + End + ')'"},
    "fontSize": 18
  },
  "width": 600,
  "height": 400,
  "data": {
    "url": "Week 10 Homework/DATA/tsunami_dataset.csv",
    "format": {"type": "csv"}
  },
  "params": [
    {
      "name": "Start",
      "value": 1970,
      "bind": {
        "input": "range",
        "min": 1970,
        "max": 2019,
        "step": 1
      }
    },
    {
      "name": "End",
      "value": 2000,
      "bind": {
        "input": "range",
        "min": 1970,
        "max": 2020,
        "step": 1
      }
    }
  ],
  "transform": [
    {"filter": "datum.mag != null"},
    {"filter": "datum.mag > 0"},
    {"filter": "datum.month != null"},
    {"filter": "datum.day != null"},
    {"filter": "datum.year != null && datum.year >= 1970"},
    {
      "calculate": "toDate(datum.year + '-' + datum.month + '-' + datum.day)",
      "as": "date"
    },
    {
      "filter": "year(datum.date) >= Start && year(datum.date) <= End"
    }
  ],
  "layer": [
    {
      "mark": {
        "type": "circle",
        "color": "#10548b"
      },
      "encoding": {
        "x": {
          "field": "date",
          "type": "temporal", 
          "title": "Year",
          "axis": {
            "titleFontSize": 15,
            "labelFontSize": 13,
            "labelAngle": 0,  
            "tickCount": 10
          }
        },
        "y": {
          "field": "mag",
          "type": "quantitative",
          "title": "Magnitude",
          "axis": {
            "titleFontSize": 15,
            "labelFontSize": 13
          },
          "scale": {"domainMin": 3}
        },
        "tooltip": [
          {"field": "country", "type": "nominal", "title": "Country"},
          {"field": "date", "type": "temporal", "title": "Date"},
          {"field": "mag", "type": "quantitative", "title": "Magnitude"}
        ]
      }
    },
    {
      "mark": {"type": "rule", "color": "red", "strokeDash": [5,5]},
      "encoding": {
        "y": {"datum": 7},
        "tooltip": {"value": "Threshold: Magnitude 7"}
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 20,
        "dy": -5,
        "fontSize": 14,
        "color": "red"
      },
      "encoding": {
        "x": {
          "value": 600  
        },
        "y": {"datum": 7},  
        "text": {"value": "Extreme Magnitudes (7+)"}
      }
    }
  ]
}